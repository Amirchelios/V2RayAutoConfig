# ๐ ุณุณุชู ุงุฏุบุงู ฺฉุงููฺฏโูุง ุณุงูู

## ๐ Overview

ุงู ุณุณุชู ุจุฑุง ุญู ูุดฺฉู ุจุงุฒููุณ (overwrite) ุดุฏู ูุงู `configs/Healthy.txt` ุทุฑุงุญ ุดุฏู ุงุณุช. ูุฏู ุงุตู ุญูุธ ฺฉุงููฺฏโูุง ูุจู ู ุงุถุงูู ฺฉุฑุฏู ฺฉุงููฺฏโูุง ุฌุฏุฏ ุณุงูู ุจุฏูู ุญุฐู ูฺ ฺฉุงููฺฏ ุงุณุช.

## ๐ ูุญูู ฺฉุงุฑ

### **1. ุงุณฺฉุฑูพุช ุงุฏุบุงู (`merge_healthy.py`)**

ุงู ุงุณฺฉุฑูพุช ูุณุฆูู ุงุฏุบุงู ฺฉุงููฺฏโูุง ูุฏู ู ุฌุฏุฏ ุงุณุช:

```bash
python3 scripts/merge_healthy.py <new_results_file> <dest_file>
```

**ูฺฺฏโูุง:**
- **ุญูุธ ุชุฑุชุจ**: ุงุจุชุฏุง ุฎุทูุท ูุฏูุ ุณูพุณ ุฎุทูุท ุฌุฏุฏ
- **ุญุฐู ุชฺฉุฑุงุฑ**: ฺฉุงููฺฏโูุง ุชฺฉุฑุงุฑ ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุญุฐู ูโุดููุฏ
- **ููุดุชู ุงุชูฺฉ**: ุงุณุชูุงุฏู ุงุฒ ูุงู ูููุช ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุฎุฑุงุจ
- **ููุชุฑ ูพุฑูุชฺฉู**: ููุท ฺฉุงููฺฏโูุง ูุนุชุจุฑ ุงุถุงูู ูโุดููุฏ

### **2. ูุฑฺฉโููู GitHub Actions (`health.yml`)**

ูุฑฺฉโููู ุฎูุฏฺฉุงุฑ ฺฉู ูุฑ ุณุงุนุช ุงุฌุฑุง ูโุดูุฏ:

```yaml
on:
  schedule:
    - cron: "0 * * * *"  # ูุฑ ุณุงุนุช
  workflow_dispatch: {}   # ุงุฌุฑุง ุฏุณุช
```

**ูุฑุงุญู:**
1. **Checkout**: ุฏุฑุงูุช ฺฉุฏ ุจุง `fetch-depth: 0`
2. **ุชุณุช ุณูุงูุช**: ุงุฌุฑุง ุงุณฺฉุฑูพุช ุชุณุช ู ุฐุฎุฑู ูุชุงุฌ
3. **ุงุฏุบุงู**: ุงุฌุฑุง `merge_healthy.py`
4. **Commit & Push**: ุฐุฎุฑู ุชุบุฑุงุช ุจุง `pull --rebase`

## ๐ง ุงูุฒุงูุงุช ูู

### **ูพุฑูุชฺฉูโูุง ูพุดุชุจุงู ุดุฏู**
```python
SCHEMES = (
    "vmess://", "vless://", "trojan://", "ss://",
    "ssr://", "hysteria://", "hysteria2://", "tuic://", "socks://"
)
```

### **ฺฉูุชุฑู ููุฒูุงู**
```yaml
concurrency:
  group: healthy-update
  cancel-in-progress: true
```

### **ุงููุช**
- ุงุณุชูุงุฏู ุงุฒ ูุงู ูููุช ุจุฑุง ููุดุชู ุงุชูฺฉ
- `pull --rebase` ูุจู ุงุฒ commit
- ุจุฑุฑุณ ุชุบุฑุงุช ูุจู ุงุฒ commit

## ๐ ุณุงุฎุชุงุฑ ูุงูโูุง

```
โโโ scripts/
โ   โโโ merge_healthy.py          # ุงุณฺฉุฑูพุช ุงุฏุบุงู
โ   โโโ README.md                 # ุงู ูุงู
โโโ .github/workflows/
โ   โโโ health.yml                # ูุฑฺฉโููู GitHub Actions
โโโ configs/
โ   โโโ Healthy.txt               # ูุงู ููุง ฺฉุงููฺฏโูุง
โโโ artifacts/
    โโโ healthy_new.txt           # ูุชุงุฌ ุชุณุช ุฌุฏุฏ
```

## ๐งช ุชุณุช ุณุณุชู

### **ุชุณุช 1: ุงุฏุบุงู ุงููู**
```bash
# ุงุฌุงุฏ ูุงู ุชุณุช ูุฏู
echo "vmess://old1" > configs/Healthy.txt
echo "vmess://old2" >> configs/Healthy.txt

# ุงุฌุงุฏ ูุงู ุชุณุช ุฌุฏุฏ
echo "vmess://new1" > artifacts/healthy_new.txt
echo "vmess://new2" >> artifacts/healthy_new.txt

# ุงุฌุฑุง ุงุฏุบุงู
python3 scripts/merge_healthy.py artifacts/healthy_new.txt configs/Healthy.txt
```

**ูุชุฌู ููุฑุฏ ุงูุชุธุงุฑ:**
```
vmess://old1
vmess://old2
vmess://new1
vmess://new2
```

### **ุชุณุช 2: ุญุฐู ุชฺฉุฑุงุฑ**
```bash
# ูุงู ุฌุฏุฏ ุดุงูู ฺฉุงููฺฏ ุชฺฉุฑุงุฑ
echo "vmess://old1" > artifacts/healthy_new.txt  # ุชฺฉุฑุงุฑ
echo "vmess://new3" >> artifacts/healthy_new.txt # ุฌุฏุฏ

# ุงุฌุฑุง ุงุฏุบุงู
python3 scripts/merge_healthy.py artifacts/healthy_new.txt configs/Healthy.txt
```

**ูุชุฌู ููุฑุฏ ุงูุชุธุงุฑ:**
```
vmess://old1
vmess://old2
vmess://new1
vmess://new2
vmess://new3
```

### **ุชุณุช 3: Idempotent**
```bash
# ุงุฌุฑุง ูุฌุฏุฏ ููุงู ุงุฏุบุงู
python3 scripts/merge_healthy.py artifacts/healthy_new.txt configs/Healthy.txt
```

**ูุชุฌู ููุฑุฏ ุงูุชุธุงุฑ:** ูฺ ุชุบุฑ ุฏุฑ ูุงู ููุง

## ๐จ ูฺฉุงุช ููู

### **1. ุญูุธ ฺฉุงููุชโูุง**
- ุงุฒ ูุงู ูุฏูุ ุชูุงู ุฎุทูุท ุบุฑุฎุงู ุญูุธ ูโุดููุฏ
- ุงุฒ ูุงู ุฌุฏุฏุ ููุท ฺฉุงููฺฏโูุง ูุนุชุจุฑ ุงุถุงูู ูโุดููุฏ

### **2. ฺฉูุชุฑู ููุฒูุงู**
- ูุฑฺฉโูููโูุง ููุฒูุงู ูุบู ูโุดููุฏ
- `concurrency.group: healthy-update`

### **3. ุงููุช**
- ููุดุชู ุงุชูฺฉ ุฑู ูุงู ูููุช
- `pull --rebase` ุจุฑุง ุฌููฺฏุฑ ุงุฒ ฺฉุงูููฺฉุช

## ๐ ุนุจโุงุจ

### **ูุดฺฉู: ูุงู merge_healthy.py ูพุฏุง ููโุดูุฏ**
```bash
# ุจุฑุฑุณ ูุฌูุฏ ูุงู
ls -la scripts/merge_healthy.py

# ุจุฑุฑุณ ูุฌูุฒูุง
chmod +x scripts/merge_healthy.py
```

### **ูุดฺฉู: ุฎุทุง ุฏุฑ ุงุฏุบุงู**
```bash
# ุจุฑุฑุณ ูุญุชูุง ูุงูโูุง
cat configs/Healthy.txt
cat artifacts/healthy_new.txt

# ุงุฌุฑุง ุฏุณุช ุงุณฺฉุฑูพุช
python3 scripts/merge_healthy.py artifacts/healthy_new.txt configs/Healthy.txt
```

### **ูุดฺฉู: ุชุบุฑุงุช commit ููโุดููุฏ**
```bash
# ุจุฑุฑุณ ูุถุนุช git
git status
git diff

# ุจุฑุฑุณ ุชุบุฑุงุช staged
git diff --cached
```

## ๐ ุจูุจูุฏูุง ุขูุฏู

### **1. ุขูุงุฑฺฏุฑ**
- ุชุนุฏุงุฏ ฺฉุงููฺฏโูุง ุงุฏุบุงู ุดุฏู
- ุฏุฑุตุฏ ุชฺฉุฑุงุฑโูุง
- ุฒูุงู ุงุฌุฑุง

### **2. ุงุนุชุจุงุฑุณูุฌ ูพุดุฑูุชู**
- ุจุฑุฑุณ ูุฑูุช ฺฉุงููฺฏโูุง
- ุชุณุช ุงุชุตุงู
- ุฑุชุจูโุจูุฏ ฺฉูุช

### **3. ูพุดุชุจุงูโฺฏุฑ**
- ูุณุฎูโูุง ูพุดุชุจุงู
- ุชุงุฑุฎฺู ุชุบุฑุงุช
- Rollback ุฎูุฏฺฉุงุฑ

## ๐ค ูุดุงุฑฺฉุช

ุจุฑุง ุจูุจูุฏ ุงู ุณุณุชู:

1. **ฺฏุฒุงุฑุด ูุดฺฉู**: Issue ุฏุฑ GitHub
2. **ูพุดููุงุฏ ุจูุจูุฏ**: Pull Request
3. **ุชุณุช**: ุงุฌุฑุง ูุฑฺฉโููู ู ุจุฑุฑุณ ูุชุงุฌ
4. **ูุณุชูุฏุณุงุฒ**: ุจูโุฑูุฒุฑุณุงู ุงู README

---

## ๐ ูพุดุชุจุงู

ุจุฑุง ุณูุงูุงุช ุง ูุดฺฉูุงุช:
- ุงุฌุงุฏ Issue ุฏุฑ GitHub
- ุจุฑุฑุณ Logs ูุฑฺฉโููู
- ุชุณุช ูุญู ุจุง ุงุณฺฉุฑูพุชโูุง
